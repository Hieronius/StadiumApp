# 1-PM---sport-club

## О приложении:

Мобильное приложение, которое позволяет искать и бронировать спортивные площадки по разным видам спорта в вашем городе.
К понравившейся площадке можно проложить кратчайший маршрут, не выходя из приложения.
У каждой локации есть своя карточка с подробной информацией.
Информация содержит адрес, телефон, сайт и приблизительную дистанцию до места.
Так же можно посмотреть фото площадки до ее посещения и сделать свой выбор.
Записаться на посещение можно в приложении в специальном окне.

## Реализованные задачи:

### 1. Работа приложения:

- Открывается страница с приветствием о возможностях приложения. ✅
- Нажимаем кнопку “Продолжить” или “Понятно”, нужно делать не push-переход, а заменить root-контроллер у NavigationController,
чтобы нельзя было вернуться назад свайпом. ✅
- Пины - это спортивные площадки. ✅
- Есть возможность отфильтровать по виду спорта и общий поиск. ✅
- При нажатии на пин на карте - открывается информация по стадиону (краткая) ✅
- При нажатии кнопки “Забронировать” открывается поле, где нужно заполнить поля: имя, номер телефона, почта. ✅
- Также возможность проложить маршрут к этому месту. ✅

### 2. Первоначальная настройка проекта:

- Ориентация проекта - портретная. ✅
- Версия проекта - 13.0 (в модуле и таргете) ✅
- Team - строго всегда none (чтобы на связать со своим аккаунтом), так же нельзя тестировать на своем реальном устройстве. ✅
- Иерархия папок проекта согласно ТЗ - ✅

#### Настройки info.plist:

- Appearance - Light. ✅
- App Uses Non-Exempt Encryption - NO. ✅
- Privacy - Location When In Use Usage Description. ✅

#### SPM:
- IQKeyboardManagerSwift. ✅
- Добавить в AppDelegate, вызывать в методе didFinishLaunchingWithOptions. ✅
- Добавить сниппет к себе в BoostNote и в проект. ✅

#### Extensions:

- showAlert() - будем часто использовать, добавить в проект и в BoostNote. ✅
- corneredRadius() - будем часто использовать, добавить в проект и в BoostNote. ✅
- addLeftImage() - для добавления картинки с левой стороны UITextField. ✅

### 3. Экран “Карта”:

- Разрешение на использования геопозиции, добавить в проект и в свой BoostNote. ✅

 #### Поиск в текстфилде:
 
- Срабатывает от 2х букв. ✅
- Фильтры площадок дополняют поиск и наоборот. Если был выбран фильтр “Волейбол”, то поиск только по площадка волейбола.
Если нажали на фильтр “волейбол”, то учитываем что написано в текстфилде. ✅
- Фильтр по категориям площадок можно снять, если нажать уже активный фильтр. ✅
- Если деактивировать все фильтры или стереть все в текстфилде, значит показываем все площадки. ✅

### Категории площадок:

- Футбол, волейбол, хоккей, теннис, баскетбол. ✅
- По 10 площадок на каждую категорию. ✅
- Город для площадок - Москва. ✅
- Фото (1 фото на площадку) ✅
- Одновременно можно только одну площадку выделить или снять выделение полностью. ✅
- Локализация площадок на русском языке. ✅

### 4. Экран “Детальный”:

- Экран открывать через метод present(), предварительно создав UINavigationController с рутовым детальным контроллером. ✅
- Прятать NavigationBar у NavigationController командой navVC.setNavigationBarHidden(true, animated: false) ✅
- Ссылка на сайт кликабельная, открывать в сафари. ✅
- Если каких-то данных нет, то писать заглушку, например, если нет сайта, писать “сайт не указан”. ✅
- Пагинацию фото настраивать через св-во у UICollectionView, isPagingEnabled = true. ❌
- Переход на экран бронирования делать через UINavigationController, методом pushViewController() ✅

### 5. Экран “Бронирование”:

#### Валидация полей:
- На заполненность, все поля обязательные. ✅
- Почту на правильность ввода. ✅
- Сделать чтобы текстфилде с телефоном можно было вводить только цифр, маска не нужна. ✅
- При нажатии на кнопку бронирования показывать алерт: тайтл: “Бронирование”,
текст: “Ваша заявка принята на бронирование принята”, кнопка “Ок”. При нажатии на “Ок” возвращаться на предыдущий экран. ✅

## Список возникших сложностей и замечаний:

- Пагинацию фото на детальном экране не делал. Реализовал через обычный image view.
Из переписки в чате понял, что collectionView делать нужно тем, у кого в figma дизайн требует подобного.

- При переходе на экран с картой и данном разрешении на использование геолокации получаем nil при обращении к текущему местоположению пользователя получаем nil. Решил с помощью добавления небольшой задержки через DispatchQueue перед определением локации. Не уверен, что это корректно. ❓

- Заметил, что при выборе размера и типа шрифта в UIButton с помощью Storyboard или в коде работает не корректно. Нужный шрифт может не отображаться, размер не соответствовать введенному. Если указаны отступы или ориентация текста в кнопке, при запуске программы эти свойства могут игнорироваться. ❓

- Не совсем понятно, как решить вопрос с "фиолетовым предупреждением" в методе checkLocationService() с текстом "This method can cause UI unresponsiveness if invoked on the main thread. Instead, consider waiting for the `-locationManagerDidChangeAuthorization:` callback and checking `authorizationStatus` first." ❓

- MapViewController "разросся" до внушительных размеров. Вероятно стоит вынести все готовые метки стадионов
в отдельный синглтон для хранения. ❓

- Не совсем понятна структура проекта связанная с заменой и подстановкой rootViewControllera для UIWindow и NavigationViewController.
Необходимо было создать UIWindow с UInavigationViewController при запуске проекта,
а затем заменить rootViewController с приветственного (WelcomeViewController) экрана на экран "Карта" (MapViewController). 
Функциональность реализовал, но не уверен, что корректно.

- Основная сложность была в реализации функции фильтра площадок. На данный момент фильтр работает следующим образом:
1. Если search text field пуст - показываем все метки на карте. ✅
2. Если search text field пуст, но нажата кнопка фильтра (вид спорта) показывает список площадок выбранной категории. ✅
3. Если начать вводить текст в text field показывает метки результат совпадения (должно быть не меньше двух символов в text field) ✅
4. При нажатии кнопки "Очистить текстовое поле", удаляем его содержимое и показываем все стадионы на карте.✅
5. При вводе текта в text field, если нажать кнопку с определенным видом спорта, на карте отобразится весь список 
площадок выбранной категории до момента нажатия "ввода" текста на клавиатуре. После этого будут скорректированы результаты поиска
в зависимости от вида выбранной площадки и набранного текста в search text field. Полагаю, не совсем верно реализовано. ❓
6. Код для реализации данной функциональности получился громоздким. Затрагивает множество элементов. Полагаю, можно улучшить со временем. ❓

#### В виду затянувшихся сроков разработки:
- реализовал calloutView внутри MapViewContoller storyboard, а не в отдельном файле.
- реализовал search text field целиком с помощью кода.

